# struct2dot

##Convert Go structs to GraphViz dot format.

**Note that this was built to deal with the use case of wanting to visualize complex XML, so this is not a generic visualizer for Go data structures.**

The worksflow to convert XMl to [Graphviz](html://www.graphviz.org)'s [`dot`](https://en.wikipedia.org/wiki/DOT_%28graph_description_language%29) format, for subsequent processing by [`neato`](http://linux.die.net/man/1/neato):

1. XML converted to Go structs using [`chidley`](https://github.com/gnewton/chidley)
2. Write simple Go program using this `struct2dot` library and structs you want from `chidley` generated Go code
3. Compile and run #2, producing `dot` format output to stdio
4. Run `neato` on `dot` file, like: `neato -Tsvg out.dot > out.svg`

##
Example code to print structs generated by `chidley` from NLM's [Medical Subject Headings (MeSHÂ®) 2016 XML](https://www.nlm.nih.gov/mesh/download_mesh.html) at [gomesh2016](https://github.com/gnewton/gomesh2016):
```
	pt := new(struct2dot)
	pt.PrintHeader()

	dr := new(gomesh2016.DescriptorRecord)
	t := reflect.TypeOf(*dr)
	pt.PrintType(t)

	sr := new(gomesh2016.SupplementalRecord)
	t = reflect.TypeOf(*sr)
	pt.PrintType(t)

	par := new(gomesh2016.PharmacologicalAction)
	t = reflect.TypeOf(*par)
	pt.PrintType(t)

	qr := new(gomesh2016.QualifierRecord)
	t = reflect.TypeOf(*qr)
	pt.PrintType(t)

	pt.PrintFooter()
}
```

Output:

<img src="https://gnewton.github.io/repos/struct2dot/meshDefault.svg">

##Configuration

The `struct2dot` type can take a `struct2dot.Config` struct, that can be used to alter the output and are generally used to make the diagram more readable. Defaults:

```
	config := struct2dot.Config{
		ShowStrings:         false,
		ShowNumbers:         false,
		RemovePackagePrefix: true,
		IgnoreTypes:         nil,
		ManualLinks:         nil,
	}
```

Links in the diagram to Go fundamental types tends to make the diagram very busy.
The following are used to control if they are included.
* `Config.ShowStrings` is a flag that indicates whether Go string types (including `[]string`) should be included
* `Config.ShowNumbers`: is a flag that indicates whether Go number types (including `[]type`)should be included

The package name prefix can also make the diagram larger and busier.
* `Config.RemovePackagePrefix` can control this

```
	config := struct2dot.Config{
		ShowStrings:         true,
		ShowNumbers:         true,
		RemovePackagePrefix: false,
		IgnoreTypes:         nil,
		ManualLinks:         nil,
	}
```

Output:
<img src="https://gnewton.github.io/repos/struct2dot/meshWithStringsAndNumbersAndPackage.svg">


### Removing types in XML
Some of the types generated by `chidley` from the XML might also cause the `dot` diagram to be too busy.
It is possible to indicate which types to be ignored:

```
	config := struct2dot.Config{
		ShowStrings:         false,
		ShowNumbers:         false,
		RemovePackagePrefix: true,
		IgnoreTypes:         []string{"gomesh2016.Year", "gomesh2016.Month", "gomesh2016.Day"},
		//ManualLinks:         map[string][]string{"DescriptorReferredTo": []string{"DescriptorRecord"}},
	}
```

Output:
<img src="https://gnewton.github.io/repos/struct2dot/meshDefaultWithIgnoreTypes.svg">